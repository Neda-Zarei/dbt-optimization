{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.11.0b3", "generated_at": "2026-01-26T13:53:28.491072Z", "invocation_id": "73cc8b02-cc0f-490d-bd6c-ac0c18e437ad", "invocation_started_at": "2026-01-26T13:53:03.113654Z", "env": {}}, "results": [{"status": "error", "timing": [{"name": "compile", "started_at": "2026-01-26T13:53:23.245106Z", "completed_at": "2026-01-26T13:53:23.268119Z"}, {"name": "execute", "started_at": "2026-01-26T13:53:23.299539Z", "completed_at": "2026-01-26T13:53:23.830462Z"}], "thread_id": "Thread-1", "execution_time": 0.6204938888549805, "adapter_response": {}, "message": "Database Error in model stg_benchmark_returns (models/pipeline_c/staging/stg_benchmark_returns.sql)\n  002003 (42S02): SQL compilation error:\n  Object 'DBT_DEMO.DEV.BENCHMARK_RETURNS' does not exist or not authorized.\n  compiled code at target/run/bain_capital_portfolio_analytics/models/pipeline_c/staging/stg_benchmark_returns.sql", "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.stg_benchmark_returns", "compiled": true, "compiled_code": "-- Pipeline C: Complex Portfolio Analytics\n-- Model: stg_benchmark_returns\n-- Description: Daily benchmark return data\n--\n-- ISSUES FOR ARTEMIS TO OPTIMIZE:\n-- 1. Self-join for cumulative returns (inefficient)\n-- 2. Multiple window functions\n\nwith source as (\n    select\n        benchmark_id,\n        return_date,\n        daily_return,\n        index_level,\n        created_at\n    from DBT_DEMO.DEV.benchmark_returns\n    where return_date >= '2020-01-01'\n),\n\n-- ISSUE: Multiple window functions that could be consolidated\nwith_cumulative as (\n    select\n        benchmark_id,\n        return_date,\n        daily_return,\n        index_level,\n        -- ISSUE: Separate window functions for each period\n        exp(sum(ln(1 + daily_return)) over (\n            partition by benchmark_id\n            order by return_date\n            rows between unbounded preceding and current row\n        )) - 1 as cumulative_return,\n        exp(sum(ln(1 + daily_return)) over (\n            partition by benchmark_id\n            order by return_date\n            rows between 29 preceding and current row\n        )) - 1 as return_30d,\n        exp(sum(ln(1 + daily_return)) over (\n            partition by benchmark_id\n            order by return_date\n            rows between 89 preceding and current row\n        )) - 1 as return_90d,\n        exp(sum(ln(1 + daily_return)) over (\n            partition by benchmark_id\n            order by return_date\n            rows between 364 preceding and current row\n        )) - 1 as return_1y,\n        stddev(daily_return) over (\n            partition by benchmark_id\n            order by return_date\n            rows between 251 preceding and current row\n        ) * sqrt(252) as annualized_volatility,\n        created_at\n    from source\n)\n\nselect * from with_cumulative", "relation_name": "DBT_DEMO.DEV_pipeline_c.stg_benchmark_returns", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2026-01-26T13:53:23.259119Z", "completed_at": "2026-01-26T13:53:23.267364Z"}, {"name": "execute", "started_at": "2026-01-26T13:53:23.268710Z", "completed_at": "2026-01-26T13:53:23.831091Z"}], "thread_id": "Thread-3", "execution_time": 0.622490644454956, "adapter_response": {}, "message": "Database Error in model stg_brokers (models/pipeline_b/staging/stg_brokers.sql)\n  002003 (42S02): SQL compilation error:\n  Object 'DBT_DEMO.DEV.BROKERS' does not exist or not authorized.\n  compiled code at target/run/bain_capital_portfolio_analytics/models/pipeline_b/staging/stg_brokers.sql", "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.stg_brokers", "compiled": true, "compiled_code": "-- Pipeline B: Trade Analytics Pipeline\n-- Model: stg_brokers\n-- Description: Staging model for broker information\n\nwith source as (\n    select\n        broker_id,\n        broker_name,\n        broker_type,\n        region,\n        is_active,\n        commission_rate,\n        created_at,\n        updated_at\n    from DBT_DEMO.DEV.brokers\n),\n\ndeduplicated as (\n    select *\n    from (\n        select\n            *,\n            row_number() over (partition by broker_id order by updated_at desc) as rn\n        from source\n    )\n    where rn = 1\n)\n\nselect\n    broker_id,\n    trim(broker_name) as broker_name,\n    upper(broker_type) as broker_type,\n    upper(region) as region,\n    is_active,\n    commission_rate,\n    created_at,\n    updated_at\nfrom deduplicated\nwhere is_active = true", "relation_name": "DBT_DEMO.DEV_pipeline_b.stg_brokers", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2026-01-26T13:53:23.263338Z", "completed_at": "2026-01-26T13:53:23.267741Z"}, {"name": "execute", "started_at": "2026-01-26T13:53:23.281282Z", "completed_at": "2026-01-26T13:53:23.830838Z"}], "thread_id": "Thread-4", "execution_time": 0.6237761974334717, "adapter_response": {}, "message": "Database Error in model stg_cashflows (models/pipeline_a/staging/stg_cashflows.sql)\n  002003 (42S02): SQL compilation error:\n  Object 'DBT_DEMO.DEV.CASHFLOWS' does not exist or not authorized.\n  compiled code at target/run/bain_capital_portfolio_analytics/models/pipeline_a/staging/stg_cashflows.sql", "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.stg_cashflows", "compiled": true, "compiled_code": "-- Pipeline A: Simple Cashflow Pipeline\n-- Model: stg_cashflows\n-- Description: Staging model for raw cashflow data\n--\n-- ISSUES FOR ARTEMIS TO OPTIMIZE:\n-- 1. Unnecessary DISTINCT (source already unique)\n-- 2. Late filtering (should push date filter upstream)\n-- 3. Non-optimal date casting\n\nwith source as (\n    select distinct  -- ISSUE: Unnecessary DISTINCT, source has unique constraint\n        cashflow_id,\n        portfolio_id,\n        cashflow_type,\n        cashflow_date,\n        amount,\n        currency,\n        created_at,\n        updated_at\n    from DBT_DEMO.DEV.cashflows\n),\n\n-- ISSUE: Heavy transformation before filtering\nconverted as (\n    select\n        cashflow_id,\n        portfolio_id,\n        upper(cashflow_type) as cashflow_type,\n        cast(cashflow_date as date) as cashflow_date,\n        cast(amount as decimal(18,2)) as amount,\n        upper(currency) as currency,\n        cast(created_at as timestamp) as created_at,\n        cast(updated_at as timestamp) as updated_at\n    from source\n),\n\n-- ISSUE: Filter applied after transformation, should be earlier\nfiltered as (\n    select *\n    from converted\n    where cashflow_date >= '2020-01-01'\n      and cashflow_date <= '2024-12-31'\n)\n\nselect * from filtered", "relation_name": "DBT_DEMO.DEV_pipeline_a.stg_cashflows", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2026-01-26T13:53:23.256065Z", "completed_at": "2026-01-26T13:53:23.268431Z"}, {"name": "execute", "started_at": "2026-01-26T13:53:23.307802Z", "completed_at": "2026-01-26T13:53:23.830124Z"}], "thread_id": "Thread-2", "execution_time": 0.6247348785400391, "adapter_response": {}, "message": "Database Error in model stg_benchmarks (models/pipeline_c/staging/stg_benchmarks.sql)\n  002003 (42S02): SQL compilation error:\n  Object 'DBT_DEMO.DEV.BENCHMARKS' does not exist or not authorized.\n  compiled code at target/run/bain_capital_portfolio_analytics/models/pipeline_c/staging/stg_benchmarks.sql", "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.stg_benchmarks", "compiled": true, "compiled_code": "-- Pipeline C: Complex Portfolio Analytics\n-- Model: stg_benchmarks\n-- Description: Benchmark index data for performance comparison\n\nwith source as (\n    select\n        benchmark_id,\n        benchmark_name,\n        benchmark_ticker,\n        benchmark_type,\n        currency,\n        is_active,\n        created_at,\n        updated_at\n    from DBT_DEMO.DEV.benchmarks\n),\n\n-- ISSUE: Subquery for deduplication\ndeduplicated as (\n    select *\n    from (\n        select\n            *,\n            row_number() over (partition by benchmark_id order by updated_at desc) as rn\n        from source\n    )\n    where rn = 1\n)\n\nselect\n    benchmark_id,\n    trim(benchmark_name) as benchmark_name,\n    upper(trim(benchmark_ticker)) as benchmark_ticker,\n    upper(benchmark_type) as benchmark_type,\n    upper(currency) as currency,\n    is_active,\n    created_at,\n    updated_at\nfrom deduplicated\nwhere is_active = true", "relation_name": "DBT_DEMO.DEV_pipeline_c.stg_benchmarks", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2026-01-26T13:53:23.879263Z", "completed_at": "2026-01-26T13:53:23.893937Z"}, {"name": "execute", "started_at": "2026-01-26T13:53:23.897728Z", "completed_at": "2026-01-26T13:53:24.369160Z"}], "thread_id": "Thread-1", "execution_time": 0.5025336742401123, "adapter_response": {}, "message": "Database Error in model stg_fund_hierarchy (models/pipeline_c/staging/stg_fund_hierarchy.sql)\n  002003 (42S02): SQL compilation error:\n  Object 'DBT_DEMO.DEV.FUND_HIERARCHY' does not exist or not authorized.\n  compiled code at target/run/bain_capital_portfolio_analytics/models/pipeline_c/staging/stg_fund_hierarchy.sql", "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.stg_fund_hierarchy", "compiled": true, "compiled_code": "-- Pipeline C: Complex Portfolio Analytics\n-- Model: stg_fund_hierarchy\n-- Description: Fund and portfolio hierarchy for roll-up reporting\n\nwith source as (\n    select\n        entity_id,\n        entity_name,\n        entity_type,\n        parent_entity_id,\n        hierarchy_level,\n        is_active,\n        created_at,\n        updated_at\n    from DBT_DEMO.DEV.fund_hierarchy\n)\n\nselect\n    entity_id,\n    trim(entity_name) as entity_name,\n    upper(entity_type) as entity_type,\n    parent_entity_id,\n    hierarchy_level,\n    is_active,\n    created_at,\n    updated_at\nfrom source\nwhere is_active = true", "relation_name": "DBT_DEMO.DEV_pipeline_c.stg_fund_hierarchy", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2026-01-26T13:53:23.883092Z", "completed_at": "2026-01-26T13:53:23.893524Z"}, {"name": "execute", "started_at": "2026-01-26T13:53:23.894577Z", "completed_at": "2026-01-26T13:53:24.387847Z"}], "thread_id": "Thread-3", "execution_time": 0.5259771347045898, "adapter_response": {}, "message": "Database Error in model stg_market_prices (models/pipeline_b/staging/stg_market_prices.sql)\n  002003 (42S02): SQL compilation error:\n  Object 'DBT_DEMO.DEV.MARKET_PRICES' does not exist or not authorized.\n  compiled code at target/run/bain_capital_portfolio_analytics/models/pipeline_b/staging/stg_market_prices.sql", "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.stg_market_prices", "compiled": true, "compiled_code": "-- Pipeline B: Trade Analytics Pipeline\n-- Model: stg_market_prices\n-- Description: Staging model for daily market prices\n--\n-- ISSUES FOR ARTEMIS TO OPTIMIZE:\n-- 1. Self-join for prior day prices (inefficient)\n-- 2. Late aggregation\n-- 3. Multiple window functions that could be consolidated\n\nwith source as (\n    select\n        security_id,\n        price_date,\n        open_price,\n        high_price,\n        low_price,\n        close_price,\n        adjusted_close,\n        volume,\n        created_at\n    from DBT_DEMO.DEV.market_prices\n    where price_date >= '2020-01-01'\n),\n\n-- ISSUE: Self-join to get prior day price (should use LAG)\nwith_prior_day as (\n    select\n        curr.security_id,\n        curr.price_date,\n        curr.open_price,\n        curr.high_price,\n        curr.low_price,\n        curr.close_price,\n        curr.adjusted_close,\n        curr.volume,\n        prev.close_price as prior_close,\n        prev.volume as prior_volume\n    from source curr\n    left join source prev\n        on curr.security_id = prev.security_id\n        and curr.price_date = dateadd('day', 1, prev.price_date)  -- ISSUE: Doesn't handle weekends\n),\n\n-- ISSUE: Multiple separate window functions\nwith_returns as (\n    select\n        *,\n        -- Daily return\n        case\n            when prior_close > 0\n            then (close_price - prior_close) / prior_close\n            else null\n        end as daily_return,\n        -- ISSUE: These could be computed together\n        avg(close_price) over (\n            partition by security_id\n            order by price_date\n            rows between 19 preceding and current row\n        ) as ma_20,\n        avg(close_price) over (\n            partition by security_id\n            order by price_date\n            rows between 49 preceding and current row\n        ) as ma_50,\n        avg(close_price) over (\n            partition by security_id\n            order by price_date\n            rows between 199 preceding and current row\n        ) as ma_200,\n        stddev(close_price) over (\n            partition by security_id\n            order by price_date\n            rows between 19 preceding and current row\n        ) as volatility_20d,\n        avg(volume) over (\n            partition by security_id\n            order by price_date\n            rows between 19 preceding and current row\n        ) as avg_volume_20d\n    from with_prior_day\n),\n\n-- ISSUE: Another pass for more calculations\nfinal as (\n    select\n        *,\n        case\n            when ma_20 > ma_50 and ma_50 > ma_200 then 'BULLISH'\n            when ma_20 < ma_50 and ma_50 < ma_200 then 'BEARISH'\n            else 'NEUTRAL'\n        end as trend_signal,\n        case\n            when volume > avg_volume_20d * 2 then 'HIGH'\n            when volume < avg_volume_20d * 0.5 then 'LOW'\n            else 'NORMAL'\n        end as volume_signal\n    from with_returns\n)\n\nselect * from final", "relation_name": "DBT_DEMO.DEV_pipeline_b.stg_market_prices", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2026-01-26T13:53:23.889006Z", "completed_at": "2026-01-26T13:53:23.897410Z"}, {"name": "execute", "started_at": "2026-01-26T13:53:23.902896Z", "completed_at": "2026-01-26T13:53:24.425765Z"}], "thread_id": "Thread-2", "execution_time": 0.5618720054626465, "adapter_response": {}, "message": "Database Error in model stg_portfolios (models/pipeline_a/staging/stg_portfolios.sql)\n  002003 (42S02): SQL compilation error:\n  Object 'DBT_DEMO.DEV.PORTFOLIOS' does not exist or not authorized.\n  compiled code at target/run/bain_capital_portfolio_analytics/models/pipeline_a/staging/stg_portfolios.sql", "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.stg_portfolios", "compiled": true, "compiled_code": "-- Pipeline A: Simple Cashflow Pipeline\n-- Model: stg_portfolios\n-- Description: Staging model for portfolio master data\n--\n-- ISSUES FOR ARTEMIS TO OPTIMIZE:\n-- 1. Subquery for deduplication instead of QUALIFY\n-- 2. Multiple passes over data\n\nwith source as (\n    select\n        portfolio_id,\n        portfolio_name,\n        portfolio_type,\n        fund_id,\n        inception_date,\n        status,\n        aum_usd,\n        created_at,\n        updated_at,\n        row_number() over (\n            partition by portfolio_id\n            order by updated_at desc\n        ) as rn\n    from DBT_DEMO.DEV.portfolios\n),\n\n-- ISSUE: Using subquery filter instead of QUALIFY\ndeduplicated as (\n    select\n        portfolio_id,\n        portfolio_name,\n        portfolio_type,\n        fund_id,\n        inception_date,\n        status,\n        aum_usd,\n        created_at,\n        updated_at\n    from source\n    where rn = 1  -- ISSUE: Should use QUALIFY in Snowflake\n),\n\n-- ISSUE: Another pass just for active filter\nactive_only as (\n    select *\n    from deduplicated\n    where status = 'ACTIVE'\n)\n\nselect * from active_only", "relation_name": "DBT_DEMO.DEV_pipeline_a.stg_portfolios", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2026-01-26T13:53:23.886329Z", "completed_at": "2026-01-26T13:53:23.894256Z"}, {"name": "execute", "started_at": "2026-01-26T13:53:23.900297Z", "completed_at": "2026-01-26T13:53:24.674742Z"}], "thread_id": "Thread-4", "execution_time": 0.8055510520935059, "adapter_response": {}, "message": "Database Error in model stg_portfolio_benchmarks (models/pipeline_c/staging/stg_portfolio_benchmarks.sql)\n  002003 (42S02): SQL compilation error:\n  Object 'DBT_DEMO.DEV.PORTFOLIO_BENCHMARKS' does not exist or not authorized.\n  compiled code at target/run/bain_capital_portfolio_analytics/models/pipeline_c/staging/stg_portfolio_benchmarks.sql", "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.stg_portfolio_benchmarks", "compiled": true, "compiled_code": "-- Pipeline C: Complex Portfolio Analytics\n-- Model: stg_portfolio_benchmarks\n-- Description: Mapping of portfolios to their benchmarks\n\nwith source as (\n    select\n        portfolio_id,\n        benchmark_id,\n        benchmark_weight,\n        effective_from,\n        effective_to,\n        is_primary,\n        created_at\n    from DBT_DEMO.DEV.portfolio_benchmarks\n)\n\nselect\n    portfolio_id,\n    benchmark_id,\n    cast(benchmark_weight as decimal(5,4)) as benchmark_weight,\n    cast(effective_from as date) as effective_from,\n    cast(effective_to as date) as effective_to,\n    is_primary,\n    created_at\nfrom source\nwhere effective_to is null or effective_to >= current_date()", "relation_name": "DBT_DEMO.DEV_pipeline_c.stg_portfolio_benchmarks", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2026-01-26T13:53:24.390455Z", "completed_at": "2026-01-26T13:53:24.403358Z"}, {"name": "execute", "started_at": "2026-01-26T13:53:24.404244Z", "completed_at": "2026-01-26T13:53:24.818599Z"}], "thread_id": "Thread-1", "execution_time": 0.4368748664855957, "adapter_response": {}, "message": "Database Error in model stg_positions_daily (models/pipeline_c/staging/stg_positions_daily.sql)\n  002003 (42S02): SQL compilation error:\n  Object 'DBT_DEMO.DEV.POSITIONS_DAILY' does not exist or not authorized.\n  compiled code at target/run/bain_capital_portfolio_analytics/models/pipeline_c/staging/stg_positions_daily.sql", "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.stg_positions_daily", "compiled": true, "compiled_code": "-- Pipeline C: Complex Portfolio Analytics\n-- Model: stg_positions_daily\n-- Description: Daily position snapshots from source system\n--\n-- ISSUES FOR ARTEMIS TO OPTIMIZE:\n-- 1. Heavy transformations before filtering\n-- 2. Unnecessary type conversions\n-- 3. Could push filters upstream\n\nwith source as (\n    select\n        position_id,\n        portfolio_id,\n        security_id,\n        position_date,\n        quantity,\n        market_value_local,\n        market_value_usd,\n        cost_basis_local,\n        cost_basis_usd,\n        unrealized_pnl_local,\n        unrealized_pnl_usd,\n        weight_pct,\n        currency,\n        fx_rate,\n        created_at\n    from DBT_DEMO.DEV.positions_daily\n),\n\n-- ISSUE: Transformations applied to all rows before filter\ntransformed as (\n    select\n        position_id,\n        portfolio_id,\n        security_id,\n        cast(position_date as date) as position_date,\n        cast(quantity as decimal(18,6)) as quantity,\n        cast(market_value_local as decimal(18,2)) as market_value_local,\n        cast(market_value_usd as decimal(18,2)) as market_value_usd,\n        cast(cost_basis_local as decimal(18,2)) as cost_basis_local,\n        cast(cost_basis_usd as decimal(18,2)) as cost_basis_usd,\n        cast(unrealized_pnl_local as decimal(18,2)) as unrealized_pnl_local,\n        cast(unrealized_pnl_usd as decimal(18,2)) as unrealized_pnl_usd,\n        cast(weight_pct as decimal(10,6)) as weight_pct,\n        upper(currency) as currency,\n        cast(fx_rate as decimal(18,8)) as fx_rate,\n        created_at\n    from source\n),\n\n-- ISSUE: Filter applied last\nfiltered as (\n    select *\n    from transformed\n    where position_date >= '2020-01-01'\n)\n\nselect * from filtered", "relation_name": "DBT_DEMO.DEV_pipeline_c.stg_positions_daily", "batch_results": null}, {"status": "skipped", "timing": [], "thread_id": "Thread-1", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.fact_cashflow_summary", "compiled": false, "compiled_code": null, "relation_name": "DBT_DEMO.DEV_pipeline_a.fact_cashflow_summary", "batch_results": null}, {"status": "skipped", "timing": [], "thread_id": "Thread-1", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.report_monthly_cashflows", "compiled": false, "compiled_code": null, "relation_name": "DBT_DEMO.DEV_pipeline_a.report_monthly_cashflows", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2026-01-26T13:53:24.412468Z", "completed_at": "2026-01-26T13:53:24.426269Z"}, {"name": "execute", "started_at": "2026-01-26T13:53:24.426785Z", "completed_at": "2026-01-26T13:53:24.846168Z"}], "thread_id": "Thread-3", "execution_time": 0.444713830947876, "adapter_response": {}, "message": "Database Error in model stg_securities (models/pipeline_b/staging/stg_securities.sql)\n  002003 (42S02): SQL compilation error:\n  Object 'DBT_DEMO.DEV.SECURITIES' does not exist or not authorized.\n  compiled code at target/run/bain_capital_portfolio_analytics/models/pipeline_b/staging/stg_securities.sql", "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.stg_securities", "compiled": true, "compiled_code": "-- Pipeline B: Trade Analytics Pipeline\n-- Model: stg_securities\n-- Description: Staging model for security master data\n--\n-- ISSUES FOR ARTEMIS TO OPTIMIZE:\n-- 1. Nested subqueries instead of QUALIFY\n-- 2. Multiple deduplication passes\n\nwith source as (\n    select\n        security_id,\n        ticker,\n        security_name,\n        security_type,\n        asset_class,\n        sector,\n        industry,\n        country,\n        currency,\n        exchange,\n        isin,\n        cusip,\n        sedol,\n        is_active,\n        created_at,\n        updated_at\n    from DBT_DEMO.DEV.securities\n),\n\n-- ISSUE: Complex deduplication using subquery\ndeduplicated as (\n    select *\n    from (\n        select\n            *,\n            row_number() over (\n                partition by security_id\n                order by updated_at desc\n            ) as rn\n        from source\n    ) sub\n    where rn = 1  -- ISSUE: Should use QUALIFY\n),\n\n-- ISSUE: Separate CTE for type standardization\nstandardized as (\n    select\n        security_id,\n        upper(trim(ticker)) as ticker,\n        trim(security_name) as security_name,\n        -- ISSUE: Repeated CASE logic found in other models\n        case\n            when security_type in ('STOCK', 'EQUITY', 'COMMON') then 'EQUITY'\n            when security_type in ('BOND', 'NOTE', 'DEBENTURE') then 'FIXED_INCOME'\n            when security_type in ('OPTION', 'FUTURE', 'SWAP') then 'DERIVATIVE'\n            when security_type in ('ETF', 'MUTUAL_FUND') then 'FUND'\n            else 'OTHER'\n        end as security_type_standardized,\n        security_type as security_type_original,\n        upper(asset_class) as asset_class,\n        sector,\n        industry,\n        upper(country) as country,\n        upper(currency) as currency,\n        exchange,\n        isin,\n        cusip,\n        sedol,\n        is_active,\n        created_at,\n        updated_at\n    from deduplicated\n)\n\nselect * from standardized\nwhere is_active = true", "relation_name": "DBT_DEMO.DEV_pipeline_b.stg_securities", "batch_results": null}, {"status": "skipped", "timing": [], "thread_id": "Thread-1", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.int_position_attribution", "compiled": false, "compiled_code": null, "relation_name": "DBT_DEMO.DEV_pipeline_c.int_position_attribution", "batch_results": null}, {"status": "skipped", "timing": [], "thread_id": "Thread-3", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.fact_position_snapshot", "compiled": false, "compiled_code": null, "relation_name": "DBT_DEMO.DEV_pipeline_c.fact_position_snapshot", "batch_results": null}, {"status": "skipped", "timing": [], "thread_id": "Thread-1", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.int_sector_attribution", "compiled": false, "compiled_code": null, "relation_name": "DBT_DEMO.DEV_pipeline_c.int_sector_attribution", "batch_results": null}, {"status": "skipped", "timing": [], "thread_id": "Thread-3", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.fact_sector_performance", "compiled": false, "compiled_code": null, "relation_name": "DBT_DEMO.DEV_pipeline_c.fact_sector_performance", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2026-01-26T13:53:24.444742Z", "completed_at": "2026-01-26T13:53:24.450019Z"}, {"name": "execute", "started_at": "2026-01-26T13:53:24.450385Z", "completed_at": "2026-01-26T13:53:24.911456Z"}], "thread_id": "Thread-2", "execution_time": 0.4755091667175293, "adapter_response": {}, "message": "Database Error in model stg_trades (models/pipeline_b/staging/stg_trades.sql)\n  002003 (42S02): SQL compilation error:\n  Object 'DBT_DEMO.DEV.TRADES' does not exist or not authorized.\n  compiled code at target/run/bain_capital_portfolio_analytics/models/pipeline_b/staging/stg_trades.sql", "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.stg_trades", "compiled": true, "compiled_code": "-- Pipeline B: Trade Analytics Pipeline\n-- Model: stg_trades\n-- Description: Staging model for trade transactions\n--\n-- ISSUES FOR ARTEMIS TO OPTIMIZE:\n-- 1. Complex CASE statements that repeat\n-- 2. Multiple CTEs doing similar transformations\n-- 3. Unnecessary string operations\n\nwith source as (\n    select\n        trade_id,\n        portfolio_id,\n        security_id,\n        trade_date,\n        settlement_date,\n        trade_type,\n        quantity,\n        price,\n        gross_amount,\n        commission,\n        fees,\n        net_amount,\n        currency,\n        counterparty_id,\n        broker_id,\n        trader_id,\n        trade_status,\n        created_at,\n        updated_at\n    from DBT_DEMO.DEV.trades\n),\n\n-- ISSUE: Repeated CASE statements for trade categorization\ncategorized as (\n    select\n        *,\n        -- ISSUE: This logic is repeated in multiple models\n        case\n            when trade_type in ('BUY', 'COVER') then 'PURCHASE'\n            when trade_type in ('SELL', 'SHORT') then 'SALE'\n            when trade_type in ('DIVIDEND', 'INTEREST') then 'INCOME'\n            else 'OTHER'\n        end as trade_category,\n        case\n            when abs(net_amount) >= 10000000 then 'LARGE'\n            when abs(net_amount) >= 1000000 then 'MEDIUM'\n            when abs(net_amount) >= 100000 then 'SMALL'\n            else 'MICRO'\n        end as trade_size_bucket,\n        -- ISSUE: Redundant string manipulation\n        upper(trim(trade_type)) as trade_type_clean,\n        upper(trim(currency)) as currency_clean,\n        upper(trim(trade_status)) as status_clean\n    from source\n),\n\n-- ISSUE: Another pass just for date calculations\nwith_dates as (\n    select\n        *,\n        datediff('day', trade_date, settlement_date) as settlement_days,\n        date_trunc('month', trade_date) as trade_month,\n        date_trunc('quarter', trade_date) as trade_quarter,\n        extract(year from trade_date) as trade_year,\n        extract(month from trade_date) as trade_month_num,\n        dayofweek(trade_date) as trade_day_of_week\n    from categorized\n),\n\n-- ISSUE: Late filtering\nfiltered as (\n    select *\n    from with_dates\n    where trade_date >= '2020-01-01'\n      and trade_status != 'CANCELLED'\n)\n\nselect * from filtered", "relation_name": "DBT_DEMO.DEV_pipeline_b.stg_trades", "batch_results": null}, {"status": "skipped", "timing": [], "thread_id": "Thread-1", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.fact_portfolio_positions", "compiled": false, "compiled_code": null, "relation_name": "DBT_DEMO.DEV_pipeline_b.fact_portfolio_positions", "batch_results": null}, {"status": "skipped", "timing": [], "thread_id": "Thread-3", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.fact_trade_summary", "compiled": false, "compiled_code": null, "relation_name": "DBT_DEMO.DEV_pipeline_b.fact_trade_summary", "batch_results": null}, {"status": "skipped", "timing": [], "thread_id": "Thread-2", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.report_trading_performance", "compiled": false, "compiled_code": null, "relation_name": "DBT_DEMO.DEV_pipeline_b.report_trading_performance", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2026-01-26T13:53:24.686473Z", "completed_at": "2026-01-26T13:53:24.691362Z"}, {"name": "execute", "started_at": "2026-01-26T13:53:24.691702Z", "completed_at": "2026-01-26T13:53:25.122509Z"}], "thread_id": "Thread-4", "execution_time": 0.44536495208740234, "adapter_response": {}, "message": "Database Error in model stg_valuations (models/pipeline_c/staging/stg_valuations.sql)\n  002003 (42S02): SQL compilation error:\n  Object 'DBT_DEMO.DEV.VALUATIONS' does not exist or not authorized.\n  compiled code at target/run/bain_capital_portfolio_analytics/models/pipeline_c/staging/stg_valuations.sql", "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.stg_valuations", "compiled": true, "compiled_code": "-- Pipeline C: Complex Portfolio Analytics\n-- Model: stg_valuations\n-- Description: Portfolio valuation data (NAV, etc.)\n--\n-- ISSUES FOR ARTEMIS TO OPTIMIZE:\n-- 1. Deduplication via subquery\n-- 2. Heavy calculations before filtering\n\nwith source as (\n    select\n        valuation_id,\n        portfolio_id,\n        valuation_date,\n        nav,\n        nav_per_share,\n        shares_outstanding,\n        gross_assets,\n        total_liabilities,\n        net_assets,\n        currency,\n        fx_rate_to_usd,\n        nav_usd,\n        created_at,\n        updated_at\n    from DBT_DEMO.DEV.valuations\n),\n\n-- ISSUE: Deduplication using subquery\ndeduplicated as (\n    select *\n    from (\n        select\n            *,\n            row_number() over (\n                partition by portfolio_id, valuation_date\n                order by updated_at desc\n            ) as rn\n        from source\n    )\n    where rn = 1\n),\n\n-- ISSUE: Filter applied after deduplication\nfiltered as (\n    select\n        valuation_id,\n        portfolio_id,\n        cast(valuation_date as date) as valuation_date,\n        cast(nav as decimal(18,2)) as nav,\n        cast(nav_per_share as decimal(18,6)) as nav_per_share,\n        cast(shares_outstanding as decimal(18,6)) as shares_outstanding,\n        cast(gross_assets as decimal(18,2)) as gross_assets,\n        cast(total_liabilities as decimal(18,2)) as total_liabilities,\n        cast(net_assets as decimal(18,2)) as net_assets,\n        upper(currency) as currency,\n        cast(fx_rate_to_usd as decimal(18,8)) as fx_rate_to_usd,\n        cast(nav_usd as decimal(18,2)) as nav_usd,\n        created_at,\n        updated_at\n    from deduplicated\n    where valuation_date >= '2020-01-01'\n)\n\nselect * from filtered", "relation_name": "DBT_DEMO.DEV_pipeline_c.stg_valuations", "batch_results": null}, {"status": "skipped", "timing": [], "thread_id": "Thread-3", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.int_benchmark_aligned", "compiled": false, "compiled_code": null, "relation_name": "DBT_DEMO.DEV_pipeline_c.int_benchmark_aligned", "batch_results": null}, {"status": "skipped", "timing": [], "thread_id": "Thread-1", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.int_portfolio_returns_daily", "compiled": false, "compiled_code": null, "relation_name": "DBT_DEMO.DEV_pipeline_c.int_portfolio_returns_daily", "batch_results": null}, {"status": "skipped", "timing": [], "thread_id": "Thread-4", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.int_portfolio_vs_benchmark", "compiled": false, "compiled_code": null, "relation_name": "DBT_DEMO.DEV_pipeline_c.int_portfolio_vs_benchmark", "batch_results": null}, {"status": "skipped", "timing": [], "thread_id": "Thread-2", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.int_risk_metrics", "compiled": false, "compiled_code": null, "relation_name": "DBT_DEMO.DEV_pipeline_c.int_risk_metrics", "batch_results": null}, {"status": "skipped", "timing": [], "thread_id": "Thread-1", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.fact_portfolio_performance", "compiled": false, "compiled_code": null, "relation_name": "DBT_DEMO.DEV_pipeline_c.fact_portfolio_performance", "batch_results": null}, {"status": "skipped", "timing": [], "thread_id": "Thread-3", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.int_fund_rollup", "compiled": false, "compiled_code": null, "relation_name": "DBT_DEMO.DEV_pipeline_c.int_fund_rollup", "batch_results": null}, {"status": "skipped", "timing": [], "thread_id": "Thread-2", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.fact_fund_summary", "compiled": false, "compiled_code": null, "relation_name": "DBT_DEMO.DEV_pipeline_c.fact_fund_summary", "batch_results": null}, {"status": "skipped", "timing": [], "thread_id": "Thread-4", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.report_lp_quarterly", "compiled": false, "compiled_code": null, "relation_name": "DBT_DEMO.DEV_pipeline_c.report_lp_quarterly", "batch_results": null}, {"status": "skipped", "timing": [], "thread_id": "Thread-3", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bain_capital_portfolio_analytics.report_ic_dashboard", "compiled": false, "compiled_code": null, "relation_name": "DBT_DEMO.DEV_pipeline_c.report_ic_dashboard", "batch_results": null}], "elapsed_time": 21.818460941314697, "args": {"favor_state": false, "introspect": true, "log_file_max_bytes": 10485760, "exclude": [], "macro_debugging": false, "printer_width": 80, "require_yaml_configuration_for_mf_time_spines": false, "source_freshness_run_project_hooks": true, "static_parser": true, "state_modified_compare_more_unrendered_values": false, "log_format": "default", "skip_nodes_if_on_run_start_fails": false, "require_explicit_package_overrides_for_builtin_materializations": true, "use_fast_test_edges": false, "invocation_command": "dbt run --full-refresh", "log_level": "info", "log_format_file": "debug", "partial_parse": true, "require_all_warnings_handled_by_warn_error": false, "empty": false, "state_modified_compare_vars": false, "show_resource_report": false, "use_colors": true, "indirect_selection": "eager", "log_path": "/Users/nedazarei/Documents/turintech/dbt/logs", "show_all_deprecations": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "full_refresh": true, "strict_mode": false, "write_json": true, "which": "run", "project_dir": "/Users/nedazarei/Documents/turintech/dbt", "cache_selected_only": false, "require_batched_execution_for_custom_microbatch_strategy": false, "select": [], "require_resource_names_without_spaces": true, "upload_to_artifacts_ingest_api": false, "use_colors_file": true, "vars": {}, "validate_macro_args": false, "profiles_dir": "/Users/nedazarei/Documents/turintech/dbt", "send_anonymous_usage_stats": true, "populate_cache": true, "require_nested_cumulative_type_params": false, "defer": false, "log_level_file": "debug", "partial_parse_file_diff": true, "quiet": false, "require_generic_test_arguments_property": true, "print": true, "version_check": true}}